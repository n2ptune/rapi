# 라즈베리 파이 4 시작하기

라즈베리 파이 4 Model B (스타터 키트) 구입처: 쿠팡

## OS 설치

동봉되어 있는 SD 카드에 OS를 설치해주면 된다. [Imager](https://www.raspberrypi.org/software/)를 이용해 [OS](https://www.raspberrypi.org/software/operating-systems/)를 설치해주면 된다.

## SSH 연결

스타터 키트에 HDMI to Micro HDMI 선이 동봉되어 있지만 모니터 문제인지 선 문제인지 모니터가 꺼졌다 켜졌다를 반복하길래 한번 내려치니 HDMI 핀이 박살... 모니터를 연결해서 GUI를 보지 않고 SSH 연결을 가능케하는 방법이 있다.

### WI-FI 자동 연결

라즈베리 파이에 꽂혀 있던 SD카드를 다시 해제하고 노트북에 연결시킨다. OS 드라이브로 들어가 `wpa_supplicant.conf` 파일을 작성한다.

```conf
ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev
update_config=1
country=KR

network={
 ssid="WI-FI 네트워크 이름"
 psk="WI-FI 네트워크 비밀번호"
}
```

라즈베리 파이 3B+ 모델 이후 `country` 속성이 필수라고 한다. 여기서는 KR로 적는다. 이 파일을 작성하면 라즈베리 파이가 부팅될 때 해당 네트워크를 자동으로 잡는다.

### SSH 구성

`ssh` 라는 이름의 파일 하나만 생성하면 자동으로 SSH 연결에 필요한 구성을 해준다.

### SSH 연결

PuTTY 같은 SSH 클라이언트를 사용해서 SSH 연결을 시도한다. 호스트 네임은 `raspberrypi`로 접속하면 되고, 기본 아이디와 패스워드는 각각 `pi`, `raspberry`로 입력한다.

> 초기에 부팅할 때 패스워드를 이미 지정했다면 그 패스워드를 입력하면 된다. 내 경우 한번 부팅을 시도해서 패스워드를 입력하고 그 뒤로 안했기 때문에 초기 패스워드가 기본값으로 되어있지 않다.

## 원격 데스크톱 연결 (Windows)

윈도우의 원격 데스크톱 연결이라는 어플리케이션을 통해 GUI를 보면서 초기 구성을 진행할 수 있다. 먼저 라즈베리 파이 쉘에서 아래 명령어로 `xrdp`를 설치한다.

```sh
sudo apt-get install xrdp
```

그런 뒤 원격 데스크톱 연결 어플리케이션을 구동해서 호스트 네임에 `raspberrypi`를 입력하면 GUI를 보고 진행할 수 있다.

## 원격 데스크톱 연결 (Mac)

[어플리케이션](https://apps.apple.com/kr/app/microsoft-remote-desktop/id1295203466?mt=12)을 이용해서 새로운 커넥션을 만들고 유저 아이디/비밀번호를 입력해서 윈도우의 원격 데스크톱 연결을 이용한 것과 비슷하게 라즈베리 파이를 GUI로 연결할 수 있다.

## 외부 네트워크

위 까지는 같은 네트워크망에 연결되어 있는 걸 전제로 하였고, 내부 네트워크 망을 벗어난 곳에서 라즈베리 파이에 접속하려면 네트워크의 고정 IP 주소를 알아야 한다. 또한 22(SSH Port)로 들어오는 요청에 대해 포트포워딩 설정을 해줘야 정상적으로 SSH 요청을 처리할 수 있다.

iptime 공유기에서는 위와 같은 설정을 매우 쉽게 설정할 수 있는데, 고급 설정 > NAT/라우터 관리 > 포트포워드 설정에서 외부에서 들어오는 어떤 포트에 대해 내부 IP의 포트로 보낼 수 있게끔 설정할 수 있다.

위 작업을 진행하기 위해서 선행해야하는 작업은 내부에서 라즈베리 파이가 사용하는 IP를 고정시켜야 하는데, 이유는 포트포워드 설정을 할 때에 내부 IP를 지정하게 되는데 이 내부 IP는 변경될 수 있으므로 한번 변경되면 포트포워드 설정을 다시 변경해야한다. 이런 불편함을 없애기 위해 라즈베리 파이가 사용하는 내부 IP를 고정시키고 포트포워드 설정을 해준다.